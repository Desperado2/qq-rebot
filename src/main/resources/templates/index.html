<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta itemprop="name" content="蒋舒婷的七选存钱罐"/>
    <meta itemprop="image" content="http://p.moimg.net/bbs_attachments/2019/06/25/20190625_1561448720_3187.jpg?imageMogr2/auto-orient/strip"/>
    <meta property="og:image" content="http://p.moimg.net/bbs_attachments/2019/06/25/20190625_1561448720_3187.jpg?imageMogr2/auto-orient/strip"/>
    <meta name="description" itemprop="description" content="今天打卡了吗？没有的话快来打个卡哦"/>

    <title>存钱罐数据流</title>

    <link rel="stylesheet" href="./plug-in/pruecss/pure-min.css">

    <!--[if lte IE 8]>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/grids-responsive-min.css">
    <!--<![endif]-->


    <!--[if lte IE 8]>
    <link rel="stylesheet" href="./plug-in/css/layouts/pricing-old-ie.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
    <link rel="stylesheet" href="./plug-in/css/layouts/pricing.css">
    <!--<![endif]-->
</head>
<body>

<div class="pricing-tables pure-g">
    <div class="pure-u-1 pure-u-md-1-1">
        <div class="pricing-table pricing-table-chart">
            <ul class="pricing-table-list">
                <li><h1>蒋舒婷的七选存钱罐</h1><span>(注：数据存在两分钟延时)</span></li>
            </ul>
        </div>
    </div>
</div>


<div class="l-content">
    <div class="pricing-tables pure-g">
        <div class="pure-u-1 pure-u-md-1-3">
            <div class="pricing-table pricing-table-free">
                <ul class="pricing-table-list">
                    <li>今日集资人数</li>
                </ul>
                <div class="pricing-table-header">
                    <span class="pricing-table-price" th:text="${data.todayUserCount}">
                    </span>
                </div>
            </div>
        </div>

        <div class="pure-u-1 pure-u-md-1-3">
            <div class="pricing-table pricing-table-free">
                <ul class="pricing-table-list">
                    <li>今日集资次数</li>
                </ul>
                <div class="pricing-table-header">
                    <span class="pricing-table-price" th:text="${data.todayUserTotal}">
                    </span>
                </div>
            </div>
        </div>

        <div class="pure-u-1 pure-u-md-1-3">
            <div class="pricing-table pricing-table-free">
                <ul class="pricing-table-list">
                    <li>今日集资总额</li>
                </ul>
                <div class="pricing-table-header">
                    <span class="pricing-table-price" th:text="${data.todayMoney}">
                    </span>
                </div>
            </div>
        </div>

    </div>
    <div class="pricing-tables pure-g">

        <div class="pure-u-1 pure-u-md-1-3">
            <div class="pricing-table pricing-table-biz pricing-table-selected">
                <ul class="pricing-table-list">
                    <li>总集资人数</li>
                </ul>
                <div class="pricing-table-header">
                    <span class="pricing-table-price" th:text="${data.allUserCount}">
                    </span>
                </div>
            </div>
        </div>

        <div class="pure-u-1 pure-u-md-1-3">
            <div class="pricing-table pricing-table-biz pricing-table-selected">
                <ul class="pricing-table-list">
                    <li>总集资次数</li>
                </ul>
                <div class="pricing-table-header">
                    <span class="pricing-table-price" th:text="${data.allUserTotal}">
                    </span>
                </div>
            </div>
        </div>

        <div class="pure-u-1 pure-u-md-1-3">
            <div class="pricing-table pricing-table-biz pricing-table-selected">
                <ul class="pricing-table-list">
                    <li>集资总额</li>
                </ul>
                <div class="pricing-table-header">
                    <span class="pricing-table-price" th:text="${data.allMoney}">
                    </span>
                </div>
            </div>
        </div>

    </div> <!-- end pricing-tables -->

    <div class="pricing-tables pure-g">
        <div class="pure-u-1 pure-u-md-1-1">
            <div class="pricing-table pricing-table-chart">
                <ul class="pricing-table-list">
                    <li>集资曲线</li>
                </ul>
                <div class="pricing-table-header">
                    <div id="main" style="height:400px"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="pricing-tables pure-g">
        <div class="pure-u-1 pure-u-md-1-1">
            <div class="pricing-table pricing-table-chart">
                <ul class="pricing-table-list">
                    <li>今日发车人员名单</li>
                </ul>
                <div class="pricing-table-header">
                    <div th:if="${data.todayUsers == null}">
                    <h2 style="color: black" th:text="'今天还差'+${25 - data.todayUserCount}+'个人才可以发车，如果你还没有抢到座，那快来抢个坐位吧'"></h2>
                    <p style="color: black">抢座链接：<a href="http://t.cn/AipEbPUL">http://t.cn/AipEbPUL</a></p>
                    </div>

                    <div th:unless="${data.todayUsers == null}">
                        <h2  style="color: black" th:text="'感想一下'+${data.todayUserCount}+'位聚聚支持，今天发车成功啦，呜啦啦啦'"></h2>
                        <p></p>
                        <table  class="pure-table pure-table-bordered"  style="width: 40%;margin:auto">
                            <thead>
                            <tr>
                                <th>支持顺序</th>
                                <th>摩点用户名</th>
                                <th>支持金额</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="user,iterStat : ${data.todayUsers}">
                                <td th:text="${iterStat.index + 1}"></td>
                                <td th:text="${user.username}"></td>
                                <td th:text="${user.money}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </div>

</div> <!-- end l-content -->


<div class="footer l-box">
    <p>
        本数据仅供参考，不保证完全准确
    </p>
</div>
</div>
<script src="./plug-in/echarts/echarts.common.min.js"></script>

<script th:inline="javascript">
    var date = [[${data.dates}]];
    var count = [[${ data.usersCount}]];
    var total = [[${data.usersTotal}]];
    var moneys = [[${data.moneys}]];
    console.log([[${data.todayUsers}]])
    // 基于准备好的dom，初始化echarts图表
    var myChart = echarts.init(document.getElementById('main'));

    var option = {
        tooltip: {
            trigger: 'axis'
        },
        legend: {
            data: ['集资人数', '集资次数', '集资金额']
        },
        toolbox: {
            show: true,
            top: 30,
            feature: {
                mark: {show: true},
                magicType: {show: true, type: ['line', 'bar', 'stack', 'tiled']},
                restore: {show: true},
                saveAsImage: {show: true}
            }
        },
        calculable: true,
        xAxis: [
            {
                type: 'category',
                boundaryGap: false,
                data: date
            }
        ],
        yAxis: [
            {
                type: 'value'
            }
        ],
        series: [
            {
                name: '集资人数',
                type: 'line',
                stack: '人数',
                data: count,
                markLine: {
                    symbol: "none",               //去掉警戒线最后面的箭头
                    label: {
                        position: "end",         //将警示值放在哪个位置，三个值“start”,"middle","end"  开始  中点 结束
                        formatter: "开车线"
                    },
                    data: [{
                        silent: false,             //鼠标悬停事件  true没有，false有
                        lineStyle: {               //警戒线的样式  ，虚实  颜色
                            type: "solid",
                            color: "rgba(238, 99, 99)"
                        },
                        name: '开车线',
                        yAxis: 25
                    }]
                }
            }, {
                name: '集资次数',
                type: 'line',
                stack: '次数',
                data: total
            }, {
                name: '集资金额',
                type: 'line',
                stack: '金额',
                data: moneys
            }
        ],

    };


    // 为echarts对象加载数据
    myChart.setOption(option);

    window.addEventListener("resize", () => {
        this.myChart.resize();
    });
</script>
</body>
</html>
